import{a as J,b as K,l as Y,m as Z,n as tt,o as et,p as it,q as nt,r as ot,s as at,t as rt,u as mt,v as st,w as lt}from"./chunk-EXFOFES3.js";import{a as N,b as z,ea as q,fa as L,ga as G,ha as W,ia as X,o as F}from"./chunk-VUXMVQJ4.js";import{Ab as v,Db as b,Fb as U,Gc as B,Hc as g,Nb as s,Ob as C,Ta as l,Ua as V,Ub as $,Vb as j,Wb as P,Xb as k,Y as R,Z as I,_b as A,ba as H,ha as O,ia as _,jb as c,lb as S,pa as w,qa as x,ub as o,vb as r,wb as T,xb as p,ya as D,yb as f}from"./chunk-VLTS26PK.js";var M=(()=>{let e=class e{constructor(i){this.httpClient=i,this.apiUrl="api/used-items"}calculateAmount(i,n){let a=new N().set("totalQuantity",i.toString()).set("unitPrice",n.toString());return this.httpClient.post(`${this.apiUrl}/calculateAmount`,null,{params:a})}deleteUsedItem(i){return this.httpClient.delete(`/api/used-items/${i}`)}};e.\u0275fac=function(n){return new(n||e)(H(z))},e.\u0275prov=R({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var ct=t=>[t,"BRL","symbol","1.2-2","pt-BR"];function pt(t,e){t&1&&(o(0,"th",14),s(1,"N\xFAmero"),r())}function ft(t,e){if(t&1&&(o(0,"td",15),s(1),r()),t&2){let m=e.$implicit;l(),C(m.id)}}function ht(t,e){t&1&&(o(0,"th",14),s(1,"Descri\xE7\xE3o"),r())}function Ct(t,e){if(t&1&&(o(0,"td",15),s(1),r()),t&2){let m=e.$implicit;l(),C(m.description)}}function It(t,e){t&1&&(o(0,"th",14),s(1,"Quantidade Total"),r())}function _t(t,e){if(t&1&&(o(0,"td",15),s(1),r()),t&2){let m=e.$implicit;l(),C(m.totalQuantity)}}function wt(t,e){t&1&&(o(0,"th",14),s(1,"Pre\xE7o Unit\xE1rio"),r())}function xt(t,e){if(t&1&&(o(0,"td",15),s(1),k(2,"currency"),r()),t&2){let m=e.$implicit;l(),C(A(2,1,P(7,ct,m.unitPrice)))}}function St(t,e){t&1&&(o(0,"th",14),s(1,"Pre\xE7o Total"),r())}function bt(t,e){if(t&1&&(o(0,"td",15),s(1),k(2,"currency"),r()),t&2){let m=e.$implicit;l(),C(A(2,1,P(7,ct,m.amount)))}}function Ut(t,e){if(t&1){let m=v();o(0,"th",16)(1,"button",17),b("click",function(){w(m);let n=U();return x(n.onAddUsedItems())}),o(2,"mat-icon"),s(3,"add"),r()()()}}function gt(t,e){if(t&1){let m=v();o(0,"td",18)(1,"button",19),b("click",function(){let n=w(m).$implicit,a=U();return x(a.onEditUsedItems(n))}),o(2,"mat-icon"),s(3,"edit"),r()(),o(4,"button",20),b("click",function(){let n=w(m).$implicit,a=U();return x(a.onDeleteUsedItems(n.id))}),o(5,"mat-icon"),s(6,"delete"),r()()()}}function Mt(t,e){t&1&&T(0,"tr",21)}function Et(t,e){t&1&&T(0,"tr",22)}var E=(()=>{let e=class e{constructor(i){this.usedItemsService=i,this.usedItems=[],this.idItemCounter=1,this.usedItemsChange=new D,this.totalAmountChange=new D,this.displayedColumnsUsedItems=["id","description","total_quantity","unit_price","amount","actions"],this.dataSourceUsedItems=new lt([])}ngOnInit(){console.log("UsedItemsComponent initialized"),this.updateTableData()}onAddUsedItems(){let i=prompt("Descri\xE7\xE3o do Item:"),n=prompt("Quantidade Total:"),a=prompt("Pre\xE7o Unit\xE1rio:"),h=n?parseFloat(n.replace(",",".")):0,d=a?parseFloat(a.replace(",",".")):0;i&&h>0&&d>0&&this.usedItemsService.calculateAmount(h,d).subscribe(u=>{this.addUsedItems({id:this.idItemCounter++,description:i,totalQuantity:h,unitPrice:d,amount:u})},u=>console.error("Erro ao calcular o valor: ",u))}onEditUsedItems(i){let n=prompt("Editar Descri\xE7\xE3o do Item:",i.description),a=prompt("Editar Quantidade Total:",i.totalQuantity.toString()),h=prompt("Editar Pre\xE7o Unit\xE1rio:",i.unitPrice.toString()),d=a?parseFloat(a.replace(",",".")):i.totalQuantity,u=h?parseFloat(h.replace(",",".")):i.unitPrice;n&&d>0&&u>0&&this.usedItemsService.calculateAmount(d,u).subscribe(y=>{i.description=n,i.totalQuantity=d,i.unitPrice=u,i.amount=y,this.updateTableData()},y=>console.error("Erro ao calcular o valor:",y))}onDeleteUsedItems(i){confirm("Tem certeza que deseja excluir o item ${id}?")&&this.usedItemsService.deleteUsedItem(i).subscribe({next:()=>{this.usedItems=this.usedItems.filter(n=>n.id!==i),this.reorganizeIds(),this.updateTableData()},error:n=>console.error("Erro ao deletar item:",n)})}addUsedItems(i){this.usedItems.push(i),this.updateTableData()}reorganizeIds(){this.usedItems.forEach((i,n)=>{i.id=n+1}),this.idItemCounter=this.usedItems.length+1}updateTableData(){this.dataSourceUsedItems.data=this.usedItems,this.usedItemsChange.emit(this.usedItems),this.emitTotalAmount()}emitTotalAmount(){let i=this.usedItems.reduce((n,a)=>n+a.amount,0);this.totalAmountChange.emit(Number(i.toFixed(2)))}};e.\u0275fac=function(n){return new(n||e)(V(M))},e.\u0275cmp=O({type:e,selectors:[["app-used-items"]],inputs:{usedItems:"usedItems",idItemCounter:"idItemCounter"},outputs:{usedItemsChange:"usedItemsChange",totalAmountChange:"totalAmountChange"},standalone:!0,features:[$([M]),j],decls:24,vars:3,consts:[[1,"used-items-container","mat-elevation-z8"],["mat-table","",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","description"],["matColumnDef","total_quantity"],["matColumnDef","unit_price"],["matColumnDef","amount"],["matColumnDef","actions"],["mat-header-cell","","class","action-header",4,"matHeaderCellDef"],["mat-cell","","class","action-column",4,"matCellDef"],["mat-header-row","","mat-header-row","",4,"matHeaderRowDef"],["mat-row","","mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-cell","",1,"action-header"],["mat-mini-fab","","color","accent","aria-label","Adicionar Item",3,"click"],["mat-cell","",1,"action-column"],["mat-icon-button","","color","primary","aria-label","Editar Item",3,"click"],["mat-icon-button","","color","warn","aria-label","Deletar Item",3,"click"],["mat-header-row","","mat-header-row",""],["mat-row","","mat-row",""]],template:function(n,a){n&1&&(o(0,"mat-card")(1,"mat-card-content")(2,"section",0)(3,"table",1),p(4,2),c(5,pt,2,0,"th",3)(6,ft,2,1,"td",4),f(),p(7,5),c(8,ht,2,0,"th",3)(9,Ct,2,1,"td",4),f(),p(10,6),c(11,It,2,0,"th",3)(12,_t,2,1,"td",4),f(),p(13,7),c(14,wt,2,0,"th",3)(15,xt,3,9,"td",4),f(),p(16,8),c(17,St,2,0,"th",3)(18,bt,3,9,"td",4),f(),p(19,9),c(20,Ut,4,0,"th",10)(21,gt,7,0,"td",11),f(),c(22,Mt,1,0,"tr",12)(23,Et,1,0,"tr",13),r()()()()),n&2&&(l(3),S("dataSource",a.dataSourceUsedItems),l(19),S("matHeaderRowDef",a.displayedColumnsUsedItems),l(),S("matRowDefColumns",a.displayedColumnsUsedItems))},dependencies:[Y,J,X,W,K,nt,it,rt,mt,st,tt,ot,et,Z,at,G,L,q,g,B],styles:[".used-items-container[_ngcontent-%COMP%]{height:400px;overflow:auto}table[_ngcontent-%COMP%]{width:100%}.mat-column-id[_ngcontent-%COMP%], .mat-column-total_quantity[_ngcontent-%COMP%], .mat-column-unit_price[_ngcontent-%COMP%], .mat-column-amount[_ngcontent-%COMP%], .mat-colummn-actions[_ngcontent-%COMP%]{white-space:unset!important;flex:0 0 10%!important;width:10%!important}.mat-column-description[_ngcontent-%COMP%]{word-wrap:break-word!important;white-space:unset!important;flex:0 0 50%!important;width:50%!important;overflow-wrap:break-word;word-break:break-word;-webkit-hyphens:auto;hyphens:auto;padding:15px}"]});let t=e;return t})();var yt=[{path:"",component:E}],dt=(()=>{let e=class e{};e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=_({type:e}),e.\u0275inj=I({imports:[F.forChild(yt),F]});let t=e;return t})();var Xt=(()=>{let e=class e{};e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=_({type:e}),e.\u0275inj=I({imports:[g,dt,E]});let t=e;return t})();export{E as a,Xt as b};
